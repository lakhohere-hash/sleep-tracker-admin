<!-- LEGENDARY NOTIFICATIONS SYSTEM - ENTERPRISE-GRADE COMMUNICATIONS -->
<div class="legendary-notifications">
  <!-- Header That Shows Communication Power -->
  <header class="notifications-header">
    <div class="header-content">
      <div class="title-section">
        <h1 class="page-title">
          <span class="title-icon">ğŸ””</span>
          Enterprise Notifications
          <span class="power-badge">MULTI-CHANNEL</span>
        </h1>
        <p class="page-subtitle">Send Powerful Communications That Drive Engagement & Revenue</p>
      </div>
      <!-- Communication Stats -->
      <div class="header-stats">
        <div class="stat-badge total-sent">
          <div class="stat-icon">ğŸ“§</div>
          <div class="stat-content">
            <span class="stat-number">{{ getTotalSent() }}</span>
            <span class="stat-label">Total Sent</span>
            <span class="stat-trend">+15 this week</span>
          </div>
        </div>
        <div class="stat-badge total-opens">
          <div class="stat-icon">ğŸ‘€</div>
          <div class="stat-content">
            <span class="stat-number">{{ getTotalOpens() | number }}</span>
            <span class="stat-label">Total Opens</span>
            <span class="stat-trend">{{ getAverageOpenRate() }}% avg rate</span>
          </div>
        </div>
        <div class="stat-badge total-conversions">
          <div class="stat-icon">ğŸ’°</div>
          <div class="stat-content">
            <span class="stat-number">{{ getTotalConversions() }}</span>
            <span class="stat-label">Conversions</span>
            <span class="stat-trend">+28% this month</span>
          </div>
        </div>
        <div class="stat-badge delivery-rate">
          <div class="stat-icon">âš¡</div>
          <div class="stat-content">
            <span class="stat-number">98.2%</span>
            <span class="stat-label">Delivery Rate</span>
            <span class="stat-trend">Industry: 92%</span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- Quick Actions Bar -->
  <section class="quick-actions" *ngIf="!isLoading">
    <div class="actions-bar">
      <button class="quick-action-btn compose-btn" (click)="showComposer = true">
        <span class="action-icon">ğŸ“</span>
        Compose New
      </button>
      <button class="quick-action-btn quick-send-btn" (click)="quickSendToAllUsers()">
        <span class="action-icon">ğŸš€</span>
        Quick Send
      </button>
      <button class="quick-action-btn ai-campaign-btn" (click)="createAICampaign()">
        <span class="action-icon">ğŸ¤–</span>
        AI Campaign
      </button>
      <button class="quick-action-btn analytics-btn" (click)="exportNotificationAnalytics()">
        <span class="action-icon">ğŸ“Š</span>
        Export Analytics
      </button>
      <button class="quick-action-btn optimize-btn" (click)="showDeliveryOptimization()">
        <span class="action-icon">âš¡</span>
        Optimize Delivery
      </button>
    </div>
  </section>

  <!-- Main Tabs Navigation -->
  <nav class="tabs-navigation">
    <div class="tabs-container">
      <button class="tab-btn"
              [class.active]="activeTab === 'notifications'"
              (click)="activeTab = 'notifications'">
        ğŸ“§ Notifications
      </button>
      <button class="tab-btn"
              [class.active]="activeTab === 'templates'"
              (click)="activeTab = 'templates'">
        ğŸ¨ Templates
      </button>
      <button class="tab-btn"
              [class.active]="activeTab === 'campaigns'"
              (click)="activeTab = 'campaigns'">
        ğŸ¯ Campaigns
      </button>
      <button class="tab-btn"
              [class.active]="activeTab === 'composer'"
              (click)="showComposer = true; activeTab = 'composer'">
        ğŸ“ Composer
      </button>
    </div>
  </nav>

  <!-- Notifications Tab -->
  <section class="notifications-tab" *ngIf="activeTab === 'notifications' && !isLoading">
    <div class="tab-header">
      <h2>ğŸ“§ Notification Management</h2>
      <div class="tab-filters">
        <input type="text" [(ngModel)]="searchTerm"
               placeholder="Search notifications..." class="search-input">
        <select [(ngModel)]="statusFilter" class="filter-select">
          <option value="all">All Status</option>
          <option value="draft">Draft</option>
          <option value="scheduled">Scheduled</option>
          <option value="sent">Sent</option>
          <option value="failed">Failed</option>
        </select>
        <select [(ngModel)]="typeFilter" class="filter-select">
          <option value="all">All Types</option>
          <option value="info">Information</option>
          <option value="success">Success</option>
          <option value="warning">Warning</option>
          <option value="error">Error</option>
          <option value="promotional">Promotional</option>
        </select>
        <select [(ngModel)]="audienceFilter" class="filter-select">
          <option value="all">All Audiences</option>
          <option value="all">All Users</option>
          <option value="premium">Premium Users</option>
          <option value="enterprise">Enterprise Users</option>
          <option value="free">Free Users</option>
          <option value="inactive">Inactive Users</option>
        </select>
      </div>
    </div>

    <div class="notifications-grid">
      <div *ngFor="let notification of getFilteredNotifications()"
           class="notification-card"
           [class]="'notification-' + notification.type">
        
        <div class="notification-header">
          <div class="notification-badges">
            <span class="type-badge" [class]="notification.type">
              {{ getTypeDisplayName(notification.type) }}
            </span>
            <span class="audience-badge" [class]="notification.audience">
              {{ getAudienceDisplayName(notification.audience) }}
            </span>
            <span class="status-badge" [class]="notification.status">
              {{ getStatusDisplayName(notification.status) }}
            </span>
          </div>
          <div class="notification-actions">
            <button class="action-btn send-btn"
                    *ngIf="notification.status === 'draft'"
                    (click)="sendNotification(notification)">
              ğŸš€ Send
            </button>
            <button class="action-btn schedule-btn"
                    *ngIf="notification.status === 'draft'"
                    (click)="scheduleNotification(notification, '2024-11-25 09:00:00')">
              â° Schedule
            </button>
            <button class="action-btn duplicate-btn"
                    (click)="duplicateNotification(notification)">
              ğŸ“‹ Duplicate
            </button>
            <button class="action-btn delete-btn"
                    (click)="deleteNotification(notification)">
              ğŸ—‘ï¸ Delete
            </button>
          </div>
        </div>

        <div class="notification-content">
          <h3 class="notification-title">{{ notification.title }}</h3>
          <p class="notification-message">{{ notification.message }}</p>
          <div class="notification-meta">
            <span class="meta-item">
              <span class="meta-icon">ğŸ“…</span>
              {{ notification.createdAt }}
            </span>
            <span class="meta-item" *ngIf="notification.sentDate">
              <span class="meta-icon">ğŸ•’</span>
              {{ notification.sentDate }}
            </span>
            <span class="meta-item" *ngIf="notification.scheduledDate">
              <span class="meta-icon">â°</span>
              {{ notification.scheduledDate }}
            </span>
          </div>
        </div>

        <!-- Analytics -->
        <div class="notification-analytics" *ngIf="notification.status === 'sent'">
          <div class="analytics-grid">
            <div class="analytic-item">
              <span class="analytic-value">{{ notification.opens | number }}</span>
              <span class="analytic-label">Opens</span>
              <span class="analytic-rate">{{ getOpenRate(notification) }}%</span>
            </div>
            <div class="analytic-item">
              <span class="analytic-value">{{ notification.clicks | number }}</span>
              <span class="analytic-label">Clicks</span>
              <span class="analytic-rate">{{ getClickRate(notification) }}%</span>
            </div>
            <div class="analytic-item">
              <span class="analytic-value">{{ notification.conversions | number }}</span>
              <span class="analytic-label">Conversions</span>
              <span class="analytic-rate">{{ getConversionRate(notification) }}%</span>
            </div>
          </div>
        </div>

        <!-- Draft Actions -->
        <div class="draft-actions" *ngIf="notification.status === 'draft'">
          <button class="test-btn" (click)="testNotification()">
            ğŸ§ª Test Send
          </button>
          <button class="edit-btn" (click)="selectedNotification = notification; showComposer = true">
            âœï¸ Edit
          </button>
        </div>
      </div>
    </div>

    <!-- Empty State -->
    <div *ngIf="getFilteredNotifications().length === 0" class="empty-state">
      <div class="empty-icon">ğŸ“§</div>
      <h3>No Notifications Found</h3>
      <p>Create your first notification to start engaging users!</p>
      <button class="create-first-btn" (click)="showComposer = true">
        ğŸš€ Create First Notification
      </button>
    </div>
  </section>

  <!-- Templates Tab -->
  <section class="templates-tab" *ngIf="activeTab === 'templates' && !isLoading">
    <div class="tab-header">
      <h2>ğŸ¨ Notification Templates</h2>
      <p>Pre-built templates for common communication scenarios</p>
    </div>
    <div class="templates-grid">
      <div *ngFor="let template of templates" class="template-card">
        <div class="template-header">
          <h3 class="template-name">{{ template.name }}</h3>
          <span class="template-category" [class]="template.category">
            {{ getCategoryDisplayName(template.category) }}
          </span>
        </div>
        <div class="template-content">
          <h4 class="template-subject">{{ template.subject }}</h4>
          <p class="template-message">{{ template.message }}</p>
        </div>
        <div class="template-stats">
          <div class="template-stat">
            <span class="stat-value">{{ template.usedCount | number }}</span>
            <span class="stat-label">Used</span>
          </div>
          <div class="template-stat">
            <span class="stat-value">{{ template.successRate }}%</span>
            <span class="stat-label">Success</span>
          </div>
        </div>
        <div class="template-actions">
          <button class="action-btn use-btn" (click)="useTemplate(template)">
            ğŸ¯ Use Template
          </button>
          <button class="action-btn preview-btn">
            ğŸ‘€ Preview
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Campaigns Tab -->
  <section class="campaigns-tab" *ngIf="activeTab === 'campaigns' && !isLoading">
    <div class="tab-header">
      <h2>ğŸ¯ Marketing Campaigns</h2>
      <button class="create-campaign-btn" (click)="createNewCampaign()">
        ğŸ¯ Create Campaign
      </button>
    </div>
    <div class="campaigns-grid">
      <div *ngFor="let campaign of campaigns" class="campaign-card">
        <div class="campaign-header">
          <h3 class="campaign-name">{{ campaign.name }}</h3>
          <span class="campaign-status" [class]="campaign.status">
            {{ campaign.status }}
          </span>
        </div>
        <div class="campaign-dates">
          <span class="date-item">
            <span class="date-label">Start:</span>
            {{ campaign.startDate }}
          </span>
          <span class="date-item">
            <span class="date-label">End:</span>
            {{ campaign.endDate }}
          </span>
        </div>
        <div class="campaign-budget">
          <div class="budget-info">
            <span class="budget-spent">${{ campaign.spent | number }}</span>
            <span class="budget-total">of ${{ campaign.budget | number }}</span>
          </div>
          <div class="budget-bar">
            <div class="budget-progress"
                 [style.width]="(campaign.spent / campaign.budget * 100) + '%'">
            </div>
          </div>
        </div>
        <div class="campaign-results">
          <div class="result-item">
            <span class="result-value">{{ campaign.results.sent | number }}</span>
            <span class="result-label">Sent</span>
          </div>
          <div class="result-item">
            <span class="result-value">{{ campaign.results.opens | number }}</span>
            <span class="result-label">Opens</span>
          </div>
          <div class="result-item">
            <span class="result-value">{{ campaign.results.conversions | number }}</span>
            <span class="result-label">Conversions</span>
          </div>
          <div class="result-item">
            <span class="result-value">${{ campaign.results.revenue | number }}</span>
            <span class="result-label">Revenue</span>
          </div>
        </div>
        <div class="campaign-actions">
          <button class="action-btn view-btn">
            ğŸ“Š View Details
          </button>
          <button class="action-btn pause-btn"
                  *ngIf="campaign.status === 'active'"
                  (click)="pauseCampaign(campaign)">
            â¸ï¸ Pause
          </button>
          <button class="action-btn duplicate-btn">
            ğŸ“‹ Duplicate
          </button>
        </div>
      </div>
    </div>
  </section>

  <!-- Composer Modal -->
  <div class="composer-modal" *ngIf="showComposer">
    <div class="composer-container">
      <div class="composer-header">
        <h2>ğŸ“ Compose Notification</h2>
        <button class="close-btn" (click)="showComposer = false">âœ•</button>
      </div>
      <div class="composer-form">
        <div class="form-group">
          <label>ğŸ“‹ Title</label>
          <input type="text" [(ngModel)]="newNotification.title"
                 class="form-input" placeholder="Enter notification title...">
        </div>
        <div class="form-group">
          <label>ğŸ’¬ Message</label>
          <textarea [(ngModel)]="newNotification.message"
                    class="form-textarea"
                    placeholder="Enter your message..."></textarea>
        </div>
        <div class="form-row">
          <div class="form-group">
            <label>ğŸ¨ Type</label>
            <select [(ngModel)]="newNotification.type" class="form-select">
              <option value="info">Information</option>
              <option value="success">Success</option>
              <option value="warning">Warning</option>
              <option value="error">Error</option>
              <option value="promotional">Promotional</option>
            </select>
          </div>
          <div class="form-group">
            <label>ğŸ¯ Audience</label>
            <select [(ngModel)]="newNotification.audience" class="form-select">
              <option value="all">All Users</option>
              <option value="premium">Premium Users</option>
              <option value="enterprise">Enterprise Users</option>
              <option value="free">Free Users</option>
              <option value="inactive">Inactive Users</option>
            </select>
          </div>
        </div>
        <div class="composer-actions">
          <button class="action-btn save-btn" (click)="createNotification()">
            ğŸ’¾ Save Draft
          </button>
          <button class="action-btn send-btn" (click)="createNotification(); sendNotification(notifications[0])">
            ğŸš€ Save & Send
          </button>
          <button class="action-btn test-btn" (click)="testNotification()">
            ğŸ§ª Test Send
          </button>
          <button class="action-btn cancel-btn" (click)="showComposer = false">
            âŒ Cancel
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="loading-animation">
      <div class="notification-loader"></div>
      <div class="loading-text">
        <span class="loading-icon">ğŸ””</span>
        Loading notification system...
      </div>
    </div>
  </div>
</div>